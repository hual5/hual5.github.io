# 数据库基本操作

数据库的基本操作是指对数据库中数据进行增、删、改、查等常见操作，这些操作通常通过 SQL（结构化查询语言）进行。常见的数据库管理系统（DBMS）包括 MySQL、PostgreSQL、SQLite、Oracle 等。

下面是数据库基本操作的概述，包括每个操作的 SQL 语句示例。

### 1. **创建数据库（Create Database）**
创建一个新的数据库，用来存储数据。

```sql
CREATE DATABASE my_database;
```

### 2. **选择数据库（Use Database）**
在进行操作之前，需要选择一个已存在的数据库。

```sql
USE my_database;
```

### 3. **创建表（Create Table）**
表是数据库中用来存储数据的结构。创建表时，我们需要定义表的列（字段）和数据类型。

```sql
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,  -- 自增主键
    name VARCHAR(100),                  -- 用户名，最大长度100
    email VARCHAR(100),                 -- 用户邮箱
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP  -- 创建时间，默认当前时间
);
```

### 4. **插入数据（Insert Data）**
插入数据是将记录插入到表中的操作。每个插入操作需要指定表的列和值。

```sql
INSERT INTO users (name, email)
VALUES ('Alice', 'alice@example.com');

INSERT INTO users (name, email)
VALUES ('Bob', 'bob@example.com');
```

### 5. **查询数据（Select Data）**
查询操作是从数据库中检索数据的操作。可以通过 `SELECT` 语句来查询数据，并可以使用不同的条件进行筛选。

```sql
-- 查询所有记录
SELECT * FROM users;

-- 查询特定的列
SELECT name, email FROM users;

-- 带条件的查询
SELECT * FROM users WHERE name = 'Alice';

-- 使用模糊查询（LIKE）
SELECT * FROM users WHERE email LIKE '%example.com%';

-- 查询并排序
SELECT * FROM users ORDER BY created_at DESC;
```

### 6. **更新数据（Update Data）**
更新数据是修改已存在记录的操作。通常使用 `UPDATE` 语句，结合 `SET` 子句来设置新的值，并通过 `WHERE` 子句指定要更新的记录。

```sql
UPDATE users
SET email = 'alice_new@example.com'
WHERE name = 'Alice';
```

### 7. **删除数据（Delete Data）**
删除数据是从表中移除记录的操作。使用 `DELETE` 语句，结合 `WHERE` 子句来指定删除的条件。

```sql
DELETE FROM users WHERE name = 'Bob';
```

### 8. **删除表（Drop Table）**
当不再需要一个表时，可以使用 `DROP TABLE` 来删除表。删除表会同时删除表中的所有数据。

```sql
DROP TABLE users;
```

### 9. **修改表（Alter Table）**
修改表结构，比如添加、删除或修改列。

```sql
-- 向表中添加一个新列
ALTER TABLE users ADD COLUMN age INT;

-- 修改列的数据类型
ALTER TABLE users MODIFY COLUMN age VARCHAR(10);

-- 删除列
ALTER TABLE users DROP COLUMN age;
```

### 10. **索引操作（Index）**
索引可以帮助加速数据库的查询操作，尤其是在处理大量数据时。

```sql
-- 创建索引
CREATE INDEX idx_user_email ON users (email);

-- 删除索引
DROP INDEX idx_user_email ON users;
```

### 11. **数据库约束（Constraints）**
数据库约束用于确保数据的完整性和一致性。常见的约束有主键约束（PRIMARY KEY）、外键约束（FOREIGN KEY）、唯一约束（UNIQUE）、非空约束（NOT NULL）等。

```sql
-- 创建表时使用约束
CREATE TABLE orders (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT,
    total DECIMAL(10, 2),
    FOREIGN KEY (user_id) REFERENCES users(id)  -- 外键约束，指向 users 表的 id 列
);
```

### 12. **事务（Transaction）**
事务是确保多个数据库操作要么全部成功，要么全部失败的一种机制。事务有四个特性：原子性、一致性、隔离性、持久性（ACID）。

```sql
-- 启动事务
START TRANSACTION;

-- 执行一系列的操作
INSERT INTO users (name, email) VALUES ('Charlie', 'charlie@example.com');
UPDATE users SET email = 'alice_updated@example.com' WHERE name = 'Alice';

-- 提交事务，保存更改
COMMIT;

-- 如果发生错误，可以回滚事务
ROLLBACK;
```

### 13. **联合查询（Join）**
联合查询用于从多个表中获取数据。最常见的联合类型有 `INNER JOIN`、`LEFT JOIN`、`RIGHT JOIN` 和 `FULL OUTER JOIN`。

```sql
-- 内连接：只返回两个表中匹配的记录
SELECT users.name, orders.total
FROM users
INNER JOIN orders ON users.id = orders.user_id;

-- 左连接：返回左表所有记录，以及匹配的右表记录（如果没有匹配，右表列将返回 NULL）
SELECT users.name, orders.total
FROM users
LEFT JOIN orders ON users.id = orders.user_id;
```

### 14. **聚合函数（Aggregate Functions）**
聚合函数用于对一组值进行计算。常见的聚合函数有 `COUNT()`、`SUM()`、`AVG()`、`MAX()`、`MIN()`。

```sql
-- 计算用户总数
SELECT COUNT(*) FROM users;

-- 计算订单的总金额
SELECT SUM(total) FROM orders;

-- 查询平均订单金额
SELECT AVG(total) FROM orders;
```

### 15. **分组（Group By）**
`GROUP BY` 语句用于将查询结果按某些列进行分组，并进行聚合计算。

```sql
-- 查询每个用户的订单总数
SELECT user_id, COUNT(*) AS order_count
FROM orders
GROUP BY user_id;
```

### 总结

数据库的基本操作涉及对数据的增、删、改、查等操作，掌握 SQL 语句可以帮助我们有效地管理和操作数据库。在实际应用中，根据需要选择合适的查询方式、索引、约束和事务等技术来保证数据的一致性、完整性和查询效率。
